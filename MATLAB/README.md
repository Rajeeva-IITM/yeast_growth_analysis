# Yeast Growth Prediction using Genome-Scale Metabolic Models

This project builds strain-specific genome-scale metabolic models (GSMMs) for yeast and uses them to predict and analyse growth phenotypes. Transcriptomics data from [Albert et al. 2018 (eLife)](https://elifesciences.org/articles/35471) is integrated with the yeast-GEM metabolic model using the GIMME algorithm to construct context-specific models for BYxRM cross strains. Predicted growth rates are compared against experimental phenotype data from [Bloom et al. 2013](https://doi.org/10.1038/ncomms3680).

## Repository Structure

```
.
├── scripts/                         # MATLAB and Python scripts
│   ├── make_ynb.m                   # Creates YNB media model from yeast-GEM
│   ├── bloom2013_strains_building.m # Builds strain-specific GIMME models
│   ├── analyse_growth_rate.m        # Compares predicted vs experimental growth
│   ├── parsimonious_FBA_yeast.m     # Runs pFBA to classify genes/reactions
│   └── sampling.py                  # Flux sampling via OptGPSampler
│
├── notebooks/                       # Jupyter notebooks
│   ├── pFBA_analysis.ipynb          # pFBA result analysis and enrichment
│   └── sampling.ipynb               # Flux sampling (notebook version)
│
├── data/                            # Input data files
│   ├── enrichment/                  # GOST/g:Profiler enrichment results
│   └── ...                          # See "Data Files" section below
│
├── models/                          # Metabolic models
│   ├── yeast-GEM.mat                # Reference yeast genome-scale model (v8)
│   ├── yeast8_ynb_final.mat         # YNB model generated by make_ynb.m
│   ├── strain_models_gimme/         # Generated GIMME strain models (gitignored)
│   └── strain_models_sprint/        # Generated Sprint strain models (gitignored)
│
├── results/                         # All outputs (gitignored)
│
├── LocalGini/                       # Context model building tools (Pavan Kumar)
└── SprintGapFiller/                 # Gap-filling tools (Pavan Kumar)
```

## Pipeline

All scripts must be run from the project root directory.

### Step 1: Create YNB media model

```matlab
% In MATLAB (requires COBRA Toolbox + Gurobi)
run('scripts/make_ynb.m')
```

Loads `models/yeast-GEM.mat`, constrains vitamin exchange reactions to define YNB minimal media, and saves the resulting model to `models/yeast8_ynb_final.mat`.

### Step 2: Build strain-specific models

```matlab
run('scripts/bloom2013_strains_building.m')
```

Reads gene expression data and the YNB base model, then builds GIMME context-specific models for each strain. Outputs are saved to `models/strain_models_gimme/`.

### Step 3: Compare growth rates

```matlab
run('scripts/analyse_growth_rate.m')
```

Loads strain models and runs FBA to obtain predicted growth rates. Compares them against experimental growth data from Bloom et al. 2013 across YNB, YPD, and Ethanol media. Outputs figures only.

### Step 4: Parsimonious FBA

```matlab
run('scripts/parsimonious_FBA_yeast.m')
```

Runs pFBA on each strain model to classify genes and reactions into categories (Essential, Optimal, ELE, MLE, ZeroFlux, Blocked). Saves results to `results/pFBA_genes_and_reactions_all_gimme.mat`.

### Step 5: pFBA analysis

Run `notebooks/pFBA_analysis.ipynb` in Jupyter. Analyses pFBA results by:
- Splitting strains into high-growth vs low-growth groups
- Computing union/intersection of gene sets across strains
- Calculating Jaccard similarity between gene categories
- Performing GO/KEGG/TF enrichment analysis
- Analysing genotype (SNP) data from Bloom 2013

### Step 6: Flux sampling

```bash
# From project root
python scripts/sampling.py
```

Or run `notebooks/sampling.ipynb`. Performs flux sampling (10,000 samples per strain) using COBRApy's OptGPSampler. Results saved as parquet files in `results/`.

## Data Files

### Provided in the repository

| File | Description | Source |
|------|-------------|--------|
| `models/yeast-GEM.mat` | Yeast genome-scale metabolic model (v8) | [yeast-GEM](https://github.com/SysBioChalmers/yeast-GEM) |
| `data/concordant_strains_ynb_gimme.csv` | Concordant strain list (GIMME) | This study |
| `data/concordant_strains_ynb.mat` | Concordant strain list (.mat) | This study |
| `data/yeast8_genes.csv` | Gene list from yeast-GEM | This study |
| `data/strains_0.5_ynb.csv` | Strain filter list (sigma=0.5) | This study |
| `data/ynb_table.csv` | Growth comparison table | This study |
| `data/gimme_growth_comparison_sigma_0.5.csv` | GIMME growth concordance | This study |
| `data/BYxRM_PhenoData.txt` | Experimental phenotype data | [Bloom et al. 2013](https://doi.org/10.1038/ncomms3680) |
| `data/bloom2013_annotations.tab` | SNP annotations | [Bloom et al. 2013](https://doi.org/10.1038/ncomms3680) |
| `data/bloom2013_genotype_concordant_strains.csv` | Genotype matrix for concordant strains | This study |
| `data/enrichment/*.csv` | Gene set enrichment results from g:Profiler | [g:Profiler](https://biit.cs.ut.ee/gprofiler/) |

### Not included (too large or generated)

| File | Size | How to obtain |
|------|------|---------------|
| `models/yeast8_ynb_final.mat` | ~537 KB | Generated by running Step 1 (`make_ynb.m`). |
| `data/expressionValues_imputed_median_antilog.csv` | ~69 MB | Gene expression matrix from [Albert et al. 2018](https://elifesciences.org/articles/35471). <!-- TODO: add download link --> |
| `models/strain_models_gimme/*.mat` | ~267 MB total | Generated by running Step 2. <!-- TODO: add download link --> |
| `models/strain_models_sprint/*.mat` | ~176 MB total | Generated by Sprint gap-filling. <!-- TODO: add download link --> |
| `results/` | Variable | All results are regenerated by running the pipeline. |

## Requirements

### MATLAB
- [COBRA Toolbox](https://opencobra.github.io/cobratoolbox/)
- [Gurobi Optimizer](https://www.gurobi.com/) (LP/MILP solver)

### Python
- [COBRApy](https://opencobra.github.io/cobrapy/)
- pandas
- polars
- numpy
- scipy
- matplotlib
- seaborn

## Acknowledgements

`LocalGini/` and `SprintGapFiller/` contain code by Pavan Kumar.
